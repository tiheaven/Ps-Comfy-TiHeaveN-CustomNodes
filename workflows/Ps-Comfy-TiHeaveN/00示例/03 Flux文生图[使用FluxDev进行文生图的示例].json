{"id":"2bdb6e72-ce2e-4feb-8ee6-14cc16ab4c44","revision":0,"last_node_id":57,"last_link_id":91,"nodes":[{"id":39,"type":"NunchakuFluxDiTLoader","pos":[-502.983335837716,-15.705709992487016],"size":[275.761328125,202],"flags":{},"order":0,"mode":0,"inputs":[{"label":"model_path","localized_name":"model_path","name":"model_path","type":"COMBO","widget":{"name":"model_path"},"link":null},{"label":"cache_threshold","localized_name":"cache_threshold","name":"cache_threshold","type":"FLOAT","widget":{"name":"cache_threshold"},"link":null},{"label":"attention","localized_name":"attention","name":"attention","type":"COMBO","widget":{"name":"attention"},"link":null},{"label":"cpu_offload","localized_name":"cpu_offload","name":"cpu_offload","type":"COMBO","widget":{"name":"cpu_offload"},"link":null},{"label":"device_id","localized_name":"device_id","name":"device_id","type":"INT","widget":{"name":"device_id"},"link":null},{"label":"data_type","localized_name":"data_type","name":"data_type","type":"COMBO","widget":{"name":"data_type"},"link":null},{"label":"i2f_mode","localized_name":"i2f_mode","name":"i2f_mode","shape":7,"type":"COMBO","widget":{"name":"i2f_mode"},"link":null}],"outputs":[{"label":"MODEL","localized_name":"模型","name":"MODEL","type":"MODEL","links":[64]}],"properties":{"cnr_id":"comfyui-nunchaku","ver":"1.0.0","Node name for S&R":"NunchakuFluxDiTLoader","ue_properties":{"widget_ue_connectable":{},"input_ue_unconnectable":{},"version":"7.3"}},"widgets_values":["svdq-int4_r32-flux.1-dev.safetensors",0,"nunchaku-fp16","auto",0,"bfloat16","enabled"]},{"id":41,"type":"NunchakuTextEncoderLoaderV2","pos":[-615.7659326548733,319.5685199098423],"size":[317.03671875,130],"flags":{},"order":1,"mode":0,"inputs":[{"label":"model_type","localized_name":"model_type","name":"model_type","type":"COMBO","widget":{"name":"model_type"},"link":null},{"label":"text_encoder1","localized_name":"text_encoder1","name":"text_encoder1","type":"COMBO","widget":{"name":"text_encoder1"},"link":null},{"label":"text_encoder2","localized_name":"text_encoder2","name":"text_encoder2","type":"COMBO","widget":{"name":"text_encoder2"},"link":null},{"label":"t5_min_length","localized_name":"t5_min_length","name":"t5_min_length","type":"INT","widget":{"name":"t5_min_length"},"link":null}],"outputs":[{"label":"CLIP","localized_name":"CLIP","name":"CLIP","type":"CLIP","links":[61,62]}],"properties":{"cnr_id":"comfyui-nunchaku","ver":"1.0.0","Node name for S&R":"NunchakuTextEncoderLoaderV2","ue_properties":{"widget_ue_connectable":{},"input_ue_unconnectable":{},"version":"7.3"}},"widgets_values":["flux.1","clip_l.safetensors","t5xxl_fp8_e4m3fn.safetensors",512]},{"id":35,"type":"FluxGuidance","pos":[383.712624292835,35.17033175511493],"size":[211.6,58],"flags":{},"order":11,"mode":0,"inputs":[{"label":"条件","localized_name":"条件","name":"conditioning","type":"CONDITIONING","link":56},{"localized_name":"引导","name":"guidance","type":"FLOAT","widget":{"name":"guidance"},"link":null}],"outputs":[{"label":"条件","localized_name":"条件","name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[65]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.71","Node name for S&R":"FluxGuidance","ue_properties":{"widget_ue_connectable":{},"version":"7.3","input_ue_unconnectable":{}}},"widgets_values":[3.5]},{"id":33,"type":"CLIPTextEncode","pos":[-44.98642317293049,381.64157813993074],"size":[422.85,164.31],"flags":{"collapsed":true},"order":8,"mode":0,"inputs":[{"label":"CLIP","localized_name":"clip","name":"clip","type":"CLIP","link":62},{"localized_name":"文本","name":"text","type":"STRING","widget":{"name":"text"},"link":null}],"outputs":[{"label":"条件","localized_name":"条件","name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[68]}],"title":"CLIP Text Encode (Negative Prompt)","properties":{"cnr_id":"comfy-core","ver":"0.3.71","Node name for S&R":"CLIPTextEncode","ue_properties":{"widget_ue_connectable":{},"version":"7.3","input_ue_unconnectable":{}}},"widgets_values":[""],"color":"#322","bgcolor":"#533"},{"id":44,"type":"ControlNetLoader","pos":[-148.8521199399773,665.7310970227205],"size":[270,58],"flags":{},"order":2,"mode":0,"inputs":[{"localized_name":"ControlNet名称","name":"control_net_name","type":"COMBO","widget":{"name":"control_net_name"},"link":null}],"outputs":[{"label":"ControlNet","localized_name":"ControlNet","name":"CONTROL_NET","type":"CONTROL_NET","links":[69,81]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.71","Node name for S&R":"ControlNetLoader","ue_properties":{"widget_ue_connectable":{},"input_ue_unconnectable":{},"version":"7.3"}},"widgets_values":["FLUX.1-dev-ControlNet-Union-Pro-2.0(fp8).safetensors"]},{"id":42,"type":"VAELoader","pos":[16.808114103283756,-0.5698460407216905],"size":[270,58],"flags":{},"order":3,"mode":0,"inputs":[{"localized_name":"vae名称","name":"vae_name","type":"COMBO","widget":{"name":"vae_name"},"link":null}],"outputs":[{"localized_name":"VAE","name":"VAE","type":"VAE","links":[63,70,84]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.71","Node name for S&R":"VAELoader","ue_properties":{"widget_ue_connectable":{},"input_ue_unconnectable":{},"version":"7.3"}},"widgets_values":["ae.safetensors"]},{"id":8,"type":"VAEDecode","pos":[1219.0526688486568,195],"size":[210,46],"flags":{},"order":17,"mode":0,"inputs":[{"label":"Latent","localized_name":"Latent","name":"samples","type":"LATENT","link":52},{"label":"VAE","localized_name":"vae","name":"vae","type":"VAE","link":63}],"outputs":[{"label":"图像","localized_name":"图像","name":"IMAGE","type":"IMAGE","slot_index":0,"links":[58]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.71","Node name for S&R":"VAEDecode","ue_properties":{"widget_ue_connectable":{},"version":"7.3","input_ue_unconnectable":{}}},"widgets_values":[]},{"id":52,"type":"PreviewImage","pos":[768.6240106408237,997.566997703269],"size":[140,246],"flags":{},"order":13,"mode":0,"inputs":[{"label":"图像","localized_name":"图像","name":"images","type":"IMAGE","link":85}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.75","Node name for S&R":"PreviewImage","ue_properties":{"widget_ue_connectable":{},"input_ue_unconnectable":{},"version":"7.3"}},"widgets_values":[]},{"id":48,"type":"PreviewImage","pos":[-19.341684108981166,1012.6200221150134],"size":[231.76995934049933,307.8648751172474],"flags":{},"order":12,"mode":0,"inputs":[{"label":"图像","localized_name":"图像","name":"images","type":"IMAGE","link":75}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.75","Node name for S&R":"PreviewImage","ue_properties":{"widget_ue_connectable":{},"input_ue_unconnectable":{},"version":"7.3"}},"widgets_values":[]},{"id":56,"type":"LoadImage","pos":[-638.5061723050765,847.904284481719],"size":[270,314],"flags":{},"order":4,"mode":0,"inputs":[{"localized_name":"图像","name":"image","type":"COMBO","widget":{"name":"image"},"link":null},{"localized_name":"选择文件上传","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"label":"图像","localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[90,91]},{"label":"遮罩","localized_name":"遮罩","name":"MASK","type":"MASK","links":null}],"title":"#02 ControlNet参考图","properties":{"cnr_id":"comfy-core","ver":"0.3.75","Node name for S&R":"LoadImage","ue_properties":{"widget_ue_connectable":{},"input_ue_unconnectable":{},"version":"7.3"},"sdppp_widgetable_title":"#02 ControlNet参考图"},"widgets_values":["1.jpg","image"]},{"id":46,"type":"AIO_Preprocessor","pos":[-164.46493120439953,795.162494222439],"size":[270,82],"flags":{},"order":9,"mode":0,"inputs":[{"label":"图像","localized_name":"image","name":"image","type":"IMAGE","link":90},{"localized_name":"预处理器","name":"preprocessor","shape":7,"type":"COMBO","widget":{"name":"preprocessor"},"link":null},{"localized_name":"分辨率","name":"resolution","shape":7,"type":"INT","widget":{"name":"resolution"},"link":null}],"outputs":[{"label":"图像","localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[73,75]}],"properties":{"cnr_id":"comfyui_controlnet_aux","ver":"1.1.2","Node name for S&R":"AIO_Preprocessor","ue_properties":{"widget_ue_connectable":{},"input_ue_unconnectable":{},"version":"7.3"},"sdppp_widgetable_title":"#03Aux集成预处理器"},"widgets_values":["DepthAnythingV2Preprocessor",1536]},{"id":43,"type":"ControlNetApplyAdvanced","pos":[186.525367831667,737.95524684135],"size":[278.8169921875,186],"flags":{},"order":14,"mode":0,"inputs":[{"label":"正面条件","localized_name":"正面条件","name":"positive","type":"CONDITIONING","link":65},{"label":"负面条件","localized_name":"负面条件","name":"negative","type":"CONDITIONING","link":68},{"label":"ControlNet","localized_name":"ControlNet","name":"control_net","type":"CONTROL_NET","link":69},{"label":"图像","localized_name":"图像","name":"image","type":"IMAGE","link":73},{"localized_name":"vae","name":"vae","shape":7,"type":"VAE","link":70},{"localized_name":"强度","name":"strength","type":"FLOAT","widget":{"name":"strength"},"link":null},{"localized_name":"开始时间","name":"start_percent","type":"FLOAT","widget":{"name":"start_percent"},"link":null},{"localized_name":"结束时间","name":"end_percent","type":"FLOAT","widget":{"name":"end_percent"},"link":null}],"outputs":[{"label":"正面条件","localized_name":"正面条件","name":"positive","type":"CONDITIONING","links":[77]},{"label":"负面条件","localized_name":"负面条件","name":"negative","type":"CONDITIONING","links":[78]}],"title":"#04 深度控制","properties":{"cnr_id":"comfy-core","ver":"0.3.71","Node name for S&R":"ControlNetApplyAdvanced","ue_properties":{"widget_ue_connectable":{},"input_ue_unconnectable":{},"version":"7.3"},"sdppp_widgetable_title":"#04 深度控制"},"widgets_values":[0.7,0,0.7]},{"id":51,"type":"AIO_Preprocessor","pos":[379.2366483008715,976.7898705115535],"size":[270,82],"flags":{},"order":10,"mode":0,"inputs":[{"label":"图像","localized_name":"image","name":"image","type":"IMAGE","link":91},{"localized_name":"预处理器","name":"preprocessor","shape":7,"type":"COMBO","widget":{"name":"preprocessor"},"link":null},{"localized_name":"分辨率","name":"resolution","shape":7,"type":"INT","widget":{"name":"resolution"},"link":null}],"outputs":[{"label":"图像","localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[83,85]}],"properties":{"cnr_id":"comfyui_controlnet_aux","ver":"1.1.2","Node name for S&R":"AIO_Preprocessor","ue_properties":{"widget_ue_connectable":{},"input_ue_unconnectable":{},"version":"7.3"},"sdppp_widgetable_title":"#03Aux集成预处理器"},"widgets_values":["CannyEdgePreprocessor",1536]},{"id":50,"type":"ControlNetApplyAdvanced","pos":[553.122843986311,713.7557143239178],"size":[278.8169921875,186],"flags":{},"order":15,"mode":0,"inputs":[{"label":"正面条件","localized_name":"正面条件","name":"positive","type":"CONDITIONING","link":77},{"label":"负面条件","localized_name":"负面条件","name":"negative","type":"CONDITIONING","link":78},{"label":"ControlNet","localized_name":"ControlNet","name":"control_net","type":"CONTROL_NET","link":81},{"label":"图像","localized_name":"图像","name":"image","type":"IMAGE","link":83},{"localized_name":"vae","name":"vae","shape":7,"type":"VAE","link":84},{"localized_name":"强度","name":"strength","type":"FLOAT","widget":{"name":"strength"},"link":null},{"localized_name":"开始时间","name":"start_percent","type":"FLOAT","widget":{"name":"start_percent"},"link":null},{"localized_name":"结束时间","name":"end_percent","type":"FLOAT","widget":{"name":"end_percent"},"link":null}],"outputs":[{"label":"正面条件","localized_name":"正面条件","name":"positive","type":"CONDITIONING","links":[79]},{"label":"负面条件","localized_name":"负面条件","name":"negative","type":"CONDITIONING","links":[80]}],"title":"#05 Canny控制","properties":{"cnr_id":"comfy-core","ver":"0.3.71","Node name for S&R":"ControlNetApplyAdvanced","ue_properties":{"widget_ue_connectable":{},"input_ue_unconnectable":{},"version":"7.3"},"sdppp_widgetable_title":"#05 Canny控制"},"widgets_values":[0.3,0.5,0.7]},{"id":31,"type":"KSampler","pos":[816,192],"size":[315,474],"flags":{},"order":16,"mode":0,"inputs":[{"label":"模型","localized_name":"模型","name":"model","type":"MODEL","link":64},{"label":"正面条件","localized_name":"正面条件","name":"positive","type":"CONDITIONING","link":79},{"label":"负面条件","localized_name":"负面条件","name":"negative","type":"CONDITIONING","link":80},{"label":"Latent","localized_name":"Latent图像","name":"latent_image","type":"LATENT","link":51},{"localized_name":"随机种","name":"seed","type":"INT","widget":{"name":"seed"},"link":null},{"localized_name":"步数","name":"steps","type":"INT","widget":{"name":"steps"},"link":null},{"localized_name":"CFG","name":"cfg","type":"FLOAT","widget":{"name":"cfg"},"link":null},{"localized_name":"采样器","name":"sampler_name","type":"COMBO","widget":{"name":"sampler_name"},"link":null},{"localized_name":"调度器","name":"scheduler","type":"COMBO","widget":{"name":"scheduler"},"link":null},{"localized_name":"降噪","name":"denoise","type":"FLOAT","widget":{"name":"denoise"},"link":null}],"outputs":[{"label":"Latent","localized_name":"Latent","name":"LATENT","type":"LATENT","slot_index":0,"links":[52]}],"title":"#10 K采样器 [seed]","properties":{"cnr_id":"comfy-core","ver":"0.3.71","Node name for S&R":"KSampler","ue_properties":{"widget_ue_connectable":{},"version":"7.3","input_ue_unconnectable":{}},"sdppp_widgetable_title":"#10 K采样器 [seed]"},"widgets_values":[125052446969488,"fixed",20,1,"euler","simple",1]},{"id":27,"type":"EmptySD3LatentImage","pos":[-84.20367485312026,495.551229691832],"size":[315,106],"flags":{},"order":5,"mode":0,"inputs":[{"localized_name":"宽度","name":"width","type":"INT","widget":{"name":"width"},"link":null},{"localized_name":"高度","name":"height","type":"INT","widget":{"name":"height"},"link":null},{"localized_name":"批次大小","name":"batch_size","type":"INT","widget":{"name":"batch_size"},"link":null}],"outputs":[{"label":"Latent","localized_name":"Latent","name":"LATENT","type":"LATENT","slot_index":0,"links":[51]}],"title":"#01 生图尺寸","properties":{"cnr_id":"comfy-core","ver":"0.3.71","Node name for S&R":"EmptySD3LatentImage","ue_properties":{"widget_ue_connectable":{},"version":"7.3","input_ue_unconnectable":{}},"sdppp_widgetable_title":"#01 生图尺寸"},"widgets_values":[1024,1536,1],"color":"#323","bgcolor":"#535"},{"id":6,"type":"CLIPTextEncode","pos":[-148.67768869366606,139.40796393688942],"size":[422.85,164.31],"flags":{},"order":7,"mode":0,"inputs":[{"label":"CLIP","localized_name":"clip","name":"clip","type":"CLIP","link":61},{"localized_name":"文本","name":"text","type":"STRING","widget":{"name":"text"},"link":null}],"outputs":[{"label":"条件","localized_name":"条件","name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[56]}],"title":"#02 提示词(英文)","properties":{"cnr_id":"comfy-core","ver":"0.3.71","Node name for S&R":"CLIPTextEncode","ue_properties":{"widget_ue_connectable":{},"version":"7.3","input_ue_unconnectable":{}},"sdppp_widgetable_title":"#02 提示词(英文)"},"widgets_values":["1girl, "],"color":"#232","bgcolor":"#353"},{"id":57,"type":"MarkdownNote","pos":[-1098.7701183422716,440.4245630232085],"size":[396.88802083333337,322.2526041666667],"flags":{},"order":6,"mode":0,"inputs":[],"outputs":[],"properties":{"ue_properties":{"widget_ue_connectable":{},"version":"7.3","input_ue_unconnectable":{}}},"widgets_values":["### 流程起点与终点\n - 与PS文档交互须以 “加载图像” 为起点(需命名为main)，“预览图像” 为终点；\n - 直接生图 建议暴露【宽高】给插件，以“预览图像” 为终点；\n\n### 节点暴露规则\n - 节点命名格式：#01 节点名 [参数1,参数2]（例：#01 K采样器 [seed,denoise]），插件仅显示指定参数（如随机种、降噪值）；\n\n- 若不指定参数（仅 #01 节点名），插件将显示整个节点的所有参数；\n\n- 建议：提前在 ComfyUI 中调试好工作流，仅暴露关键参数至插件；\n\n"],"color":"#432","bgcolor":"#653"},{"id":38,"type":"PreviewImage","pos":[1540.0766837338233,335.5339594290008],"size":[408.75488092574597,395.4539337830977],"flags":{},"order":18,"mode":0,"inputs":[{"label":"图像","localized_name":"图像","name":"images","type":"IMAGE","link":58}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.71","Node name for S&R":"PreviewImage","ue_properties":{"widget_ue_connectable":{},"input_ue_unconnectable":{},"version":"7.3"}},"widgets_values":[]}],"links":[[51,27,0,31,3,"LATENT"],[52,31,0,8,0,"LATENT"],[56,6,0,35,0,"CONDITIONING"],[58,8,0,38,0,"IMAGE"],[61,41,0,6,0,"CLIP"],[62,41,0,33,0,"CLIP"],[63,42,0,8,1,"VAE"],[64,39,0,31,0,"MODEL"],[65,35,0,43,0,"CONDITIONING"],[68,33,0,43,1,"CONDITIONING"],[69,44,0,43,2,"CONTROL_NET"],[70,42,0,43,4,"VAE"],[73,46,0,43,3,"IMAGE"],[75,46,0,48,0,"IMAGE"],[77,43,0,50,0,"CONDITIONING"],[78,43,1,50,1,"CONDITIONING"],[79,50,0,31,1,"CONDITIONING"],[80,50,1,31,2,"CONDITIONING"],[81,44,0,50,2,"CONTROL_NET"],[83,51,0,50,3,"IMAGE"],[84,42,0,50,4,"VAE"],[85,51,0,52,0,"IMAGE"],[90,56,0,46,0,"IMAGE"],[91,56,0,51,0,"IMAGE"]],"groups":[{"id":1,"title":"终点使用【预览图像】才能返图给PS 不用暴露","bounding":[1506.592134068338,251.54435719485485,619.8257874088927,554.5817897322929],"color":"#3f789e","font_size":24,"flags":{}}],"config":{},"extra":{"ds":{"scale":0.7627768444385546,"offset":[-1035.9433425934933,8.033527796841152]},"ue_links":[],"links_added_by_ue":[],"workflowRendererVersion":"LG"},"version":0.4}