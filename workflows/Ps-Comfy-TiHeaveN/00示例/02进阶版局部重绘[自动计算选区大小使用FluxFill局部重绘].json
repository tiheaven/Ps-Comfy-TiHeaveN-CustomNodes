{"id":"551d82b0-b1fb-483a-a5ea-564bdb813625","revision":0,"last_node_id":59,"last_link_id":125,"nodes":[{"id":26,"type":"FluxGuidance","pos":[120,230],"size":[317.3999938964844,58],"flags":{},"order":9,"mode":0,"inputs":[{"label":"条件","localized_name":"条件","name":"conditioning","type":"CONDITIONING","link":41},{"localized_name":"引导","name":"guidance","type":"FLOAT","widget":{"name":"guidance"},"link":null}],"outputs":[{"label":"条件","localized_name":"条件","name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[80]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"FluxGuidance","ue_properties":{"widget_ue_connectable":{},"version":"7.3","input_ue_unconnectable":{}}},"widgets_values":[30]},{"id":46,"type":"ConditioningZeroOut","pos":[120,330],"size":[197.712890625,26],"flags":{},"order":10,"mode":0,"inputs":[{"label":"条件","localized_name":"条件","name":"conditioning","type":"CONDITIONING","link":101}],"outputs":[{"label":"条件","localized_name":"条件","name":"CONDITIONING","type":"CONDITIONING","links":[102]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"ConditioningZeroOut","ue_properties":{"widget_ue_connectable":{},"version":"7.3","input_ue_unconnectable":{}}},"widgets_values":[]},{"id":39,"type":"DifferentialDiffusion","pos":[110,-120],"size":[277.20001220703125,58],"flags":{},"order":5,"mode":0,"inputs":[{"label":"模型","localized_name":"模型","name":"model","type":"MODEL","link":85},{"localized_name":"strength","name":"strength","shape":7,"type":"FLOAT","widget":{"name":"strength"},"link":null}],"outputs":[{"label":"模型","localized_name":"模型","name":"MODEL","type":"MODEL","slot_index":0,"links":[86]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"DifferentialDiffusion","ue_properties":{"widget_ue_connectable":{},"version":"7.3","input_ue_unconnectable":{}}},"widgets_values":[1]},{"id":31,"type":"UNETLoader","pos":[-240,-80],"size":[315,82],"flags":{},"order":0,"mode":0,"inputs":[{"localized_name":"UNET名称","name":"unet_name","type":"COMBO","widget":{"name":"unet_name"},"link":null},{"localized_name":"剪枝类型","name":"weight_dtype","type":"COMBO","widget":{"name":"weight_dtype"},"link":null}],"outputs":[{"label":"模型","localized_name":"模型","name":"MODEL","type":"MODEL","slot_index":0,"links":[85]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"UNETLoader","models":[{"name":"flux1-fill-dev.safetensors","url":"https://huggingface.co/Comfy-Org/flux1-dev/resolve/main/split_files/diffusion_models/flux1-fill-dev.safetensors","directory":"diffusion_models"}],"ue_properties":{"widget_ue_connectable":{},"version":"7.3","input_ue_unconnectable":{}}},"widgets_values":["flux1-fill-dev-fp8.safetensors","fp8_e4m3fn"]},{"id":34,"type":"DualCLIPLoader","pos":[-240,50],"size":[315,130],"flags":{},"order":1,"mode":0,"inputs":[{"localized_name":"CLIP1","name":"clip_name1","type":"COMBO","widget":{"name":"clip_name1"},"link":null},{"localized_name":"CLIP2","name":"clip_name2","type":"COMBO","widget":{"name":"clip_name2"},"link":null},{"localized_name":"类型","name":"type","type":"COMBO","widget":{"name":"type"},"link":null},{"localized_name":"设备","name":"device","shape":7,"type":"COMBO","widget":{"name":"device"},"link":null}],"outputs":[{"label":"CLIP","localized_name":"CLIP","name":"CLIP","type":"CLIP","links":[62]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"DualCLIPLoader","models":[{"name":"clip_l.safetensors","url":"https://huggingface.co/comfyanonymous/flux_text_encoders/resolve/main/clip_l.safetensors","directory":"text_encoders"},{"name":"t5xxl_fp16.safetensors","url":"https://huggingface.co/comfyanonymous/flux_text_encoders/resolve/main/t5xxl_fp16.safetensors","directory":"text_encoders"}],"ue_properties":{"widget_ue_connectable":{},"version":"7.3","input_ue_unconnectable":{}}},"widgets_values":["clip_l.safetensors","t5xxl_fp8_e4m3fn.safetensors","flux","default"]},{"id":32,"type":"VAELoader","pos":[-240,220],"size":[315,58],"flags":{},"order":2,"mode":0,"inputs":[{"localized_name":"vae名称","name":"vae_name","type":"COMBO","widget":{"name":"vae_name"},"link":null}],"outputs":[{"localized_name":"VAE","name":"VAE","type":"VAE","slot_index":0,"links":[60,82]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"VAELoader","models":[{"name":"ae.safetensors","url":"https://huggingface.co/Comfy-Org/Lumina_Image_2.0_Repackaged/resolve/main/split_files/vae/ae.safetensors","directory":"vae"}],"ue_properties":{"widget_ue_connectable":{},"version":"7.3","input_ue_unconnectable":{}}},"widgets_values":["ae.safetensors"]},{"id":48,"type":"GetImageSize","pos":[-1149.6790480758268,87.17781340057387],"size":[276.3333988262891,124.00000000000001],"flags":{},"order":7,"mode":0,"inputs":[{"label":"图像","localized_name":"image","name":"image","type":"IMAGE","link":108}],"outputs":[{"label":"宽度","localized_name":"width","name":"width","type":"INT","links":[104]},{"label":"高度","localized_name":"height","name":"height","type":"INT","links":[105]},{"localized_name":"batch_size","name":"batch_size","type":"INT","links":[]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.65","Node name for S&R":"GetImageSize","ue_properties":{"widget_ue_connectable":{},"input_ue_unconnectable":{},"version":"7.3"}},"widgets_values":["width: 266, height: 213\n batch size: 1"]},{"id":49,"type":"ImpactInt","pos":[-1148.3286481717944,221.12056520736795],"size":[251.26100000000008,58],"flags":{},"order":3,"mode":0,"inputs":[{"localized_name":"值","name":"value","type":"INT","widget":{"name":"value"},"link":null}],"outputs":[{"label":"整数","localized_name":"整数","name":"INT","type":"INT","links":[106]}],"properties":{"cnr_id":"comfyui-impact-pack","ver":"8.25.1","Node name for S&R":"ImpactInt","ue_properties":{"widget_ue_connectable":{},"input_ue_unconnectable":{},"version":"7.3"},"sdppp_max":100,"sdppp_min":0},"widgets_values":[1024],"color":"#322","bgcolor":"#533"},{"id":50,"type":"MathExpression|pysssss","pos":[-839.9083512189649,143.94434132213453],"size":[302.2199903919153,128],"flags":{},"order":11,"mode":0,"inputs":[{"label":"a","localized_name":"a","name":"a","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":104},{"label":"b","localized_name":"b","name":"b","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":105},{"label":"c","localized_name":"c","name":"c","shape":7,"type":"INT,FLOAT,IMAGE,LATENT","link":106},{"localized_name":"表达式","name":"expression","type":"INT,FLOAT,IMAGE,LATENT","widget":{"name":"expression"},"link":null}],"outputs":[{"label":"整数","localized_name":"整数","name":"INT","type":"INT","links":[107]},{"label":"浮点","localized_name":"浮点","name":"FLOAT","type":"FLOAT","links":[]}],"title":"计算长边的值","properties":{"cnr_id":"comfyui-custom-scripts","ver":"1.2.5","ue_properties":{"widget_ue_connectable":{},"input_ue_unconnectable":{},"version":"7.3"}},"widgets_values":["max(round(a * ((max(a,b)<c)*(c/max(a,b)) + ((c<=max(a,b))*(max(a,b)<=2048))*1 + (max(a,b)>2048)*(2048/max(a,b)))), round(b * ((max(a,b)<c)*(c/max(a,b)) + ((c<=max(a,b))*(max(a,b)<=2048))*1 + (max(a,b)>2048)*(2048/max(a,b)))))"]},{"id":8,"type":"VAEDecode","pos":[904.1159999999994,-97.07600000000001],"size":[210,46],"flags":{},"order":15,"mode":0,"inputs":[{"label":"Latent","localized_name":"Latent","name":"samples","type":"LATENT","link":7},{"label":"VAE","localized_name":"vae","name":"vae","type":"VAE","link":60}],"outputs":[{"label":"图像","localized_name":"图像","name":"IMAGE","type":"IMAGE","slot_index":0,"links":[113]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"VAEDecode","ue_properties":{"widget_ue_connectable":{},"version":"7.3","input_ue_unconnectable":{}}},"widgets_values":[]},{"id":51,"type":"LayerUtility: ImageScaleByAspectRatio V2","pos":[-516.341637362399,420.8104978557251],"size":[270,330],"flags":{},"order":12,"mode":0,"inputs":[{"label":"图像","localized_name":"image","name":"image","shape":7,"type":"IMAGE","link":109},{"label":"遮罩","localized_name":"mask","name":"mask","shape":7,"type":"MASK","link":110},{"localized_name":"宽高比","name":"aspect_ratio","type":"COMBO","widget":{"name":"aspect_ratio"},"link":null},{"localized_name":"比例宽","name":"proportional_width","type":"INT","widget":{"name":"proportional_width"},"link":null},{"localized_name":"比例高","name":"proportional_height","type":"INT","widget":{"name":"proportional_height"},"link":null},{"localized_name":"缩放模式","name":"fit","type":"COMBO","widget":{"name":"fit"},"link":null},{"localized_name":"采样方法","name":"method","type":"COMBO","widget":{"name":"method"},"link":null},{"localized_name":"倍数取整","name":"round_to_multiple","type":"COMBO","widget":{"name":"round_to_multiple"},"link":null},{"localized_name":"缩放到边","name":"scale_to_side","type":"COMBO","widget":{"name":"scale_to_side"},"link":null},{"localized_name":"缩放到长度","name":"scale_to_length","type":"INT","widget":{"name":"scale_to_length"},"link":107},{"localized_name":"background_color","name":"background_color","type":"STRING","widget":{"name":"background_color"},"link":null}],"outputs":[{"label":"图像","localized_name":"image","name":"image","type":"IMAGE","links":[111]},{"label":"遮罩","localized_name":"mask","name":"mask","type":"MASK","links":[112,114]},{"label":"原始大小","localized_name":"original_size","name":"original_size","type":"BOX","links":[115]},{"localized_name":"width","name":"width","type":"INT","links":[]},{"localized_name":"height","name":"height","type":"INT","links":[]}],"properties":{"cnr_id":"comfyui_layerstyle","ver":"1.0.90","Node name for S&R":"LayerUtility: ImageScaleByAspectRatio V2","ue_properties":{"widget_ue_connectable":{},"input_ue_unconnectable":{},"version":"7.3"}},"widgets_values":["original",1,1,"letterbox","lanczos","None","longest",1024,"#000000"],"color":"rgba(38, 73, 116, 0.7)"},{"id":17,"type":"LoadImage","pos":[-1527.0770000000002,429.2470000000009],"size":[315,314],"flags":{},"order":4,"mode":0,"inputs":[{"localized_name":"图像","name":"image","type":"COMBO","widget":{"name":"image"},"link":null},{"localized_name":"选择文件上传","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"label":"图像","localized_name":"图像","name":"IMAGE","type":"IMAGE","slot_index":0,"links":[108,109]},{"label":"遮罩","localized_name":"遮罩","name":"MASK","type":"MASK","slot_index":1,"links":[110,125]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"LoadImage","ue_properties":{"widget_ue_connectable":{},"version":"7.3","input_ue_unconnectable":{}}},"widgets_values":["flux_fill_inpaint_example_input_image.png","image"]},{"id":52,"type":"LayerUtility: ImageScaleRestore V2","pos":[824.1939519241728,429.7281978557242],"size":[270,210],"flags":{},"order":16,"mode":0,"inputs":[{"label":"图像","localized_name":"image","name":"image","type":"IMAGE","link":113},{"label":"遮罩","localized_name":"mask","name":"mask","shape":7,"type":"MASK","link":114},{"label":"原始大小","localized_name":"original_size","name":"original_size","shape":7,"type":"BOX","link":115},{"localized_name":"缩放","name":"scale","type":"FLOAT","widget":{"name":"scale"},"link":null},{"localized_name":"采样方法","name":"method","type":"COMBO","widget":{"name":"method"},"link":null},{"localized_name":"缩放方法","name":"scale_by","type":"COMBO","widget":{"name":"scale_by"},"link":null},{"localized_name":"缩放长度","name":"scale_by_length","type":"INT","widget":{"name":"scale_by_length"},"link":null}],"outputs":[{"label":"图像","localized_name":"image","name":"image","type":"IMAGE","links":[121]},{"label":"遮罩","localized_name":"mask","name":"mask","type":"MASK","links":null},{"label":"原始大小","localized_name":"original_size","name":"original_size","type":"BOX","links":null},{"localized_name":"width","name":"width","type":"INT","links":null},{"localized_name":"height","name":"height","type":"INT","links":null}],"properties":{"cnr_id":"comfyui_layerstyle","ver":"unknown","Node name for S&R":"LayerUtility: ImageScaleRestore V2","ue_properties":{"widget_ue_connectable":{"scale":true,"method":true,"scale_by":true,"scale_by_length":true},"version":"7.2.2","input_ue_unconnectable":{}}},"widgets_values":[1,"lanczos","by_scale",1546],"color":"rgba(38, 73, 116, 0.7)"},{"id":57,"type":"JoinImageWithAlpha","pos":[1229.3805710077113,588.1171978557245],"size":[140,46],"flags":{},"order":17,"mode":0,"inputs":[{"label":"图像","localized_name":"图像","name":"image","type":"IMAGE","link":121},{"label":"透明遮罩","localized_name":"阿尔法","name":"alpha","type":"MASK","link":124}],"outputs":[{"label":"图像","localized_name":"图像","name":"IMAGE","type":"IMAGE","links":[122]}],"properties":{"cnr_id":"comfy-core","ver":"0.3.44","Node name for S&R":"JoinImageWithAlpha","ue_properties":{"widget_ue_connectable":{},"version":"7.2.2","input_ue_unconnectable":{}}},"widgets_values":[]},{"id":47,"type":"PreviewImage","pos":[1491.0249519241752,517.5741978557237],"size":[299.72,398.68000000000006],"flags":{},"order":18,"mode":0,"inputs":[{"label":"图像","localized_name":"图像","name":"images","type":"IMAGE","link":122}],"outputs":[],"properties":{"cnr_id":"comfy-core","ver":"0.3.68","Node name for S&R":"PreviewImage","ue_properties":{"widget_ue_connectable":{},"input_ue_unconnectable":{},"version":"7.3"}},"widgets_values":[]},{"id":23,"type":"CLIPTextEncode","pos":[120,30],"size":[422.8500061035156,164.30999755859375],"flags":{},"order":6,"mode":0,"inputs":[{"label":"CLIP","localized_name":"clip","name":"clip","type":"CLIP","link":62},{"localized_name":"文本","name":"text","type":"STRING","widget":{"name":"text"},"link":null}],"outputs":[{"label":"条件","localized_name":"条件","name":"CONDITIONING","type":"CONDITIONING","slot_index":0,"links":[41,101]}],"title":"#03 提示词 可串接翻译节点","properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"CLIPTextEncode","ue_properties":{"widget_ue_connectable":{},"version":"7.3","input_ue_unconnectable":{}},"sdppp_widgetable_title":"#03 提示词 可串接翻译节点"},"widgets_values":[""],"color":"#232","bgcolor":"#353"},{"id":59,"type":"GrowMaskWithBlur","pos":[736.2631437664486,749.9167970379503],"size":[278.748046875,299],"flags":{},"order":8,"mode":0,"inputs":[{"label":"遮罩","localized_name":"mask","name":"mask","type":"MASK","link":125},{"localized_name":"扩展","name":"expand","type":"INT","widget":{"name":"expand"},"link":null},{"localized_name":"扩展增量","name":"incremental_expandrate","type":"FLOAT","widget":{"name":"incremental_expandrate"},"link":null},{"localized_name":"倒角","name":"tapered_corners","type":"BOOLEAN","widget":{"name":"tapered_corners"},"link":null},{"localized_name":"反转输入","name":"flip_input","type":"BOOLEAN","widget":{"name":"flip_input"},"link":null},{"localized_name":"模糊半径","name":"blur_radius","type":"FLOAT","widget":{"name":"blur_radius"},"link":null},{"localized_name":"线性透明","name":"lerp_alpha","type":"FLOAT","widget":{"name":"lerp_alpha"},"link":null},{"localized_name":"腐蚀系数","name":"decay_factor","type":"FLOAT","widget":{"name":"decay_factor"},"link":null},{"localized_name":"fill_holes","name":"fill_holes","shape":7,"type":"BOOLEAN","widget":{"name":"fill_holes"},"link":null}],"outputs":[{"label":"遮罩","localized_name":"mask","name":"mask","type":"MASK","links":[124]},{"label":"反转遮罩","localized_name":"mask_inverted","name":"mask_inverted","type":"MASK","links":null}],"title":"#01 返图时羽化 [blur_radius]","properties":{"ue_properties":{"widget_ue_connectable":{},"input_ue_unconnectable":{},"version":"7.3"},"aux_id":"ComfyUI-KJNodes","ver":"bb205d809b467307b8ec3bb1a22680a4873187f8","Node name for S&R":"GrowMaskWithBlur","sdppp_widgetable_title":"#01 返图时羽化 [blur_radius]"},"widgets_values":[0,0,false,true,10,1,1,false]},{"id":38,"type":"InpaintModelConditioning","pos":[120,420],"size":[302.3999938964844,138],"flags":{},"order":13,"mode":0,"inputs":[{"label":"正面条件","localized_name":"正面条件","name":"positive","type":"CONDITIONING","link":80},{"label":"负面条件","localized_name":"负面条件","name":"negative","type":"CONDITIONING","link":102},{"label":"VAE","localized_name":"vae","name":"vae","type":"VAE","link":82},{"label":"图像","localized_name":"像素","name":"pixels","type":"IMAGE","link":111},{"label":"遮罩","localized_name":"遮罩","name":"mask","type":"MASK","link":112},{"localized_name":"噪波遮罩","name":"noise_mask","type":"BOOLEAN","widget":{"name":"noise_mask"},"link":null}],"outputs":[{"label":"正面条件","localized_name":"正面条件","name":"positive","type":"CONDITIONING","slot_index":0,"links":[77]},{"label":"负面条件","localized_name":"负面条件","name":"negative","type":"CONDITIONING","slot_index":1,"links":[78]},{"label":"Latent","localized_name":"Latent","name":"latent","type":"LATENT","slot_index":2,"links":[88]}],"title":"#02 内补模型条件","properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"InpaintModelConditioning","ue_properties":{"widget_ue_connectable":{},"version":"7.3","input_ue_unconnectable":{}},"sdppp_widgetable_title":"#02 内补模型条件"},"widgets_values":[true]},{"id":3,"type":"KSampler","pos":[580,-120],"size":[290,470],"flags":{},"order":14,"mode":0,"inputs":[{"label":"模型","localized_name":"模型","name":"model","type":"MODEL","link":86},{"label":"正面条件","localized_name":"正面条件","name":"positive","type":"CONDITIONING","link":77},{"label":"负面条件","localized_name":"负面条件","name":"negative","type":"CONDITIONING","link":78},{"label":"Latent","localized_name":"Latent图像","name":"latent_image","type":"LATENT","link":88},{"localized_name":"随机种","name":"seed","type":"INT","widget":{"name":"seed"},"link":null},{"localized_name":"步数","name":"steps","type":"INT","widget":{"name":"steps"},"link":null},{"localized_name":"CFG","name":"cfg","type":"FLOAT","widget":{"name":"cfg"},"link":null},{"localized_name":"采样器","name":"sampler_name","type":"COMBO","widget":{"name":"sampler_name"},"link":null},{"localized_name":"调度器","name":"scheduler","type":"COMBO","widget":{"name":"scheduler"},"link":null},{"localized_name":"降噪","name":"denoise","type":"FLOAT","widget":{"name":"denoise"},"link":null}],"outputs":[{"label":"Latent","localized_name":"Latent","name":"LATENT","type":"LATENT","slot_index":0,"links":[7]}],"title":"#04 K采样器 [seed,denoise]","properties":{"cnr_id":"comfy-core","ver":"0.3.64","Node name for S&R":"KSampler","ue_properties":{"widget_ue_connectable":{},"version":"7.3","input_ue_unconnectable":{}},"sdppp_widgetable_title":"#04 K采样器 [seed,denoise]"},"widgets_values":[656821733471329,"randomize",20,1,"euler","normal",1]}],"links":[[7,3,0,8,0,"LATENT"],[41,23,0,26,0,"CONDITIONING"],[60,32,0,8,1,"VAE"],[62,34,0,23,0,"CLIP"],[77,38,0,3,1,"CONDITIONING"],[78,38,1,3,2,"CONDITIONING"],[80,26,0,38,0,"CONDITIONING"],[82,32,0,38,2,"VAE"],[85,31,0,39,0,"MODEL"],[86,39,0,3,0,"MODEL"],[88,38,2,3,3,"LATENT"],[101,23,0,46,0,"CONDITIONING"],[102,46,0,38,1,"CONDITIONING"],[104,48,0,50,0,"INT,FLOAT,IMAGE,LATENT"],[105,48,1,50,1,"INT,FLOAT,IMAGE,LATENT"],[106,49,0,50,2,"INT,FLOAT,IMAGE,LATENT"],[107,50,0,51,9,"INT"],[108,17,0,48,0,"IMAGE"],[109,17,0,51,0,"IMAGE"],[110,17,1,51,1,"MASK"],[111,51,0,38,3,"IMAGE"],[112,51,1,38,4,"MASK"],[113,8,0,52,0,"IMAGE"],[114,51,1,52,1,"MASK"],[115,51,2,52,2,"BOX"],[121,52,0,57,0,"IMAGE"],[122,57,0,47,0,"IMAGE"],[124,59,0,57,1,"MASK"],[125,17,1,59,0,"MASK"]],"groups":[{"id":1,"title":"Step 1 - Load models","bounding":[-250,-150,335,441.6000061035156],"color":"#3f789e","font_size":24,"flags":{}},{"id":2,"title":"Step 2 - Upload image","bounding":[-1537.0770000000002,359.2470000000009,335,397.6000061035156],"color":"#3f789e","font_size":24,"flags":{}},{"id":3,"title":"Step 3 - Prompt","bounding":[110,-40,442.8499755859375,409.6000061035156],"color":"#3f789e","font_size":24,"flags":{}}],"config":{},"extra":{"ds":{"scale":0.6830134553650705,"offset":[978.2272562335527,230.63530296205036]},"frontendVersion":"1.29.2","VHS_latentpreview":false,"VHS_latentpreviewrate":0,"VHS_MetadataImage":true,"VHS_KeepIntermediate":true,"ue_links":[]},"version":0.4}